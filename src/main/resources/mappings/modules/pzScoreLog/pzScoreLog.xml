<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dhc.rad.modules.pzScoreLog.dao.PzScoreLogDao">
    <resultMap id="BaseResultMap" type="com.dhc.rad.modules.pzScoreLog.entity.PzScoreLog" >
        <result column="user_id" property="userId" />
        <result column="restaurant_id" property="restaurantId" />
        <result column="score_type" property="scoreType" />
        <result column="score_description" property="scoreDescription" />
        <result column="score_change" property="scoreChange" />
        <result column="score_classify" property="scoreClassify" />
        <result column="create_by" property="createBy.id" />
        <result column="update_by" property="updateBy.id" />
        <result column="create_date" property="createDate" />
        <result column="update_date" property="updateDate" />
        <result column="remarks" property="remarks" />
        <result column="del_flag" property="delFlag" />
    </resultMap>

    <update id="deleteByIds">
        UPDATE pz_score_log
        SET
        del_flag = '1'
        WHERE id in
        <foreach collection="list" item="id" index="index"
                 open="(" close=")" separator=",">
            #{id}
        </foreach>
    </update>

    <select id="get" resultMap="BaseResultMap">
        SELECT
            a.ID,
            a.user_id,
            a.restaurant_id,
            a.score_type,
            a.score_description,
            a.score_change,
            a.score_classify,
            a.create_by,
            a.update_by,
            a.create_date,
            a.update_date,
            a.remarks,
            a.del_flag
        FROM pz_score_log a
        WHERE a.ID = #{id} and a.del_flag ='0'
    </select>

    <insert id="insert" parameterType="com.dhc.rad.modules.pzScoreLog.entity.PzScoreLog">
        INSERT INTO pz_score_log
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test ="null != id and ''!= id">
                id,
            </if>
            <if test ="null != userId and ''!= userId">
                user_id,
            </if>
            <if test ="null != restaurantId and ''!= restaurantId">
                restaurant_id,
            </if>
            <if test ="null != scoreType">
                score_type,
            </if>
            <if test ="null != scoreChange and ''!= scoreChange">
                score_change,
            </if>
            <if test ="null != scoreDescription and ''!= scoreDescription">
                score_description,
            </if>
            <if test ="null != scoreClassify">
                score_classify,
            </if>
            <if test ="null != createBy and ''!= createBy">
                create_by,
            </if>
            <if test ="null != updateBy and ''!= updateBy">
                update_by,
            </if>
            <if test ="null != createDate and ''!= createDate">
                create_date,
            </if>
            <if test ="null != updateDate and ''!= updateDate">
                update_date,
            </if>
            <if test ="null != remarks and ''!= remarks">
                remarks,
            </if>
            <if test ="null != delFlag and ''!= delFlag">
                del_flag
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test ="null != id and ''!= id">
                #{id},
            </if>
            <if test ="null != userId and ''!= userId">
                #{userId},
            </if>
            <if test ="null != restaurantId and ''!= restaurantId">
                #{restaurantId},
            </if>
            <if test ="null != scoreType">
                #{scoreType},
            </if>
            <if test ="null != scoreChange and ''!= scoreChange">
                #{scoreChange},
            </if>
            <if test ="null != scoreDescription and ''!= scoreDescription">
                #{scoreDescription},
            </if>
            <if test ="null != scoreClassify">
                #{scoreClassify},
            </if>
            <if test ="null != createBy and ''!= createBy">
                #{createBy.id},
            </if>
            <if test ="null != updateBy and ''!= updateBy">
                #{updateBy.id},
            </if>
            <if test ="null != createDate and ''!= createDate">
                #{createDate},
            </if>
            <if test ="null != updateDate and ''!= updateDate">
                #{updateDate},
            </if>
            <if test ="null != remarks and ''!= remarks">
                #{remarks},
            </if>
            <if test ="null != delFlag and ''!= delFlag">
                #{delFlag}
            </if>
        </trim>
    </insert>

    <update id="update" parameterType="com.dhc.rad.modules.pzScoreLog.entity.PzScoreLog">
        UPDATE pz_score_log
        <set>
            <if test ="null != userId and ''!= userId">  user_id= #{userId},</if>
            <if test ="null != restaurantId and ''!= restaurantId">  restaurant_id= #{restaurantId},</if>
            <if test ="null != scoreType and ''!= scoreType">  score_type = #{scoreType},</if>
            <if test ="null != scoreDescription and ''!= scoreDescription">  score_description = #{scoreDescription},</if>
            <if test ="null != scoreChange and ''!= scoreChange">  score_change = #{scoreChange},</if>
            <if test ="null != scoreClassify and ''!= scoreClassify">  score_classify = #{scoreClassify},</if>
            <if test ="null != createBy and ''!= createBy">  CREATE_BY = #{createBy.id},</if>
            <if test ="null != updateBy and ''!= updateBy">  UPDATE_BY = #{updateBy.id},</if>
            <if test ="null != createDate and ''!= createDate">  CREATE_DATE = #{createDate},</if>
            <if test ="null != updateDate and ''!= updateDate">  UPDATE_DATE = #{updateDate},</if>
            <if test ="null != remarks and ''!= remarks">  remarks = #{remarks}</if>
        </set>
        WHERE  id = #{id} and del_flag ='0'
    </update>


    <select id="findList" resultMap="BaseResultMap">
        SELECT
        ID,
        user_id,
        restaurant_id,
        score_type,
        score_description,
        score_change,
        score_classify,
        create_by,
        update_by,
        create_date,
        update_date,
        remarks,
        del_flag
        FROM
        pz_score_log
        WHERE del_flag ='0'
        <if test ="null != userId and ''!= userId">AND  user_id= #{userId}</if>
        <if test ="null != restaurantId and ''!= restaurantId"> AND restaurant_id= #{restaurantId}</if>
        <if test ="null != scoreType and ''!= scoreType"> AND score_type = #{scoreType}</if>
        <if test ="null != scoreDescription and ''!= scoreDescription"> AND score_description = #{scoreDescription}</if>
        <if test ="null != scoreChange and ''!= scoreChange"> AND score_change = #{scoreChange}</if>
        <if test ="null != scoreClassify and ''!= scoreClassify"> AND score_classify = #{scoreClassify}</if>
        <if test ="null != createBy and ''!= createBy"> AND CREATE_BY = #{createBy.id}</if>
        <if test ="null != updateBy and ''!= updateBy"> AND UPDATE_BY = #{updateBy.id}</if>
        <if test ="null != createDate and ''!= createDate"> AND CREATE_DATE = #{createDate}</if>
        <if test ="null != updateDate and ''!= updateDate"> AND UPDATE_DATE = #{updateDate}</if>
        <if test ="null != remarks and ''!= remarks"> AND remarks = #{remarks}</if>
        <choose>
            <when test="page !=null and page.orderBy != null and page.orderBy != ''">
                ORDER BY ${page.orderBy}
            </when>
            <otherwise>
                ORDER BY  create_date DESC
            </otherwise>
        </choose>

    </select>
    <select id="findScoreById" resultMap="BaseResultMap">
        SELECT
        ID,
        user_id,
        restaurant_id,
        score_type,
        score_description,
        score_change,
        score_classify,
        create_by,
        update_by,
        create_date,
        update_date,
        remarks,
        del_flag
        FROM
        pz_score_log
        WHERE del_flag ='0' and user_id = #{userId}
        <if test ="null != restaurantId and ''!= restaurantId"> AND restaurant_id= #{restaurantId}</if>
        <if test ="null != scoreType and ''!= scoreType">AND  score_type = #{scoreType}</if>
        <if test ="null != scoreDescription and ''!= scoreDescription"> AND score_description = #{scoreDescription}</if>
        <if test ="null != scoreChange and ''!= scoreChange"> AND score_change = #{scoreChange}</if>
        <if test ="null != scoreClassify and ''!= scoreClassify"> AND score_classify = #{scoreClassify}</if>
        <if test ="null != createBy and ''!= createBy"> AND CREATE_BY = #{createBy.id}</if>
        <if test ="null != updateBy and ''!= updateBy"> AND UPDATE_BY = #{updateBy.id}</if>
        <if test ="null != createDate and ''!= createDate"> AND CREATE_DATE = #{createDate}</if>
        <if test ="null != updateDate and ''!= updateDate"> AND UPDATE_DATE = #{updateDate}</if>
        <if test ="null != remarks and ''!= remarks"> AND remarks = #{remarks}</if>
        <choose>
            <when test="page !=null and page.orderBy != null and page.orderBy != ''">
                ORDER BY ${page.orderBy}
            </when>
            <otherwise>
                ORDER BY  create_date DESC
            </otherwise>
        </choose>
    </select>
</mapper>